# Variable-Selection-with-Reinforcement-Learning

This repository is the official implementation of the paper `Variable-Selection-with-Reinforcement-Learning` submitted to ICML 2022.

## Requirements

- Python version: Python 3.6.8 :: Anaconda custom (64-bit)

### Main packages for the proposed estimator

- numpy == 1.18.1
- pandas == 1.0.3
- sklearn == 0.22.1
- pytorch == 1.4.0

### Additional packages for experiments

- os
- sys
- random
- matplotlib

### Hardware

- Precision Tower 7910
- CPU：Intel(R) Xeon(R) CPU E5-2640 v4 @ 2.40GHz （2 physical CPUs with 10 cores each）

## Reproduce simulation results

We provide example codes in `regression.ipynb` and `classification.ipynb`.

For **synthetic data analysis**, we consider cases in the table below.

| True Function \$f\$ ​                                         | Details                                                      |
| ------------------------------------------------------------ | ------------------------------------------------------------ |
| 1. \$y = \sum_{j=1}^8 \beta_j x_j\$​                          | \$x_j \stackrel{i.i.d}{\sim} N(0, 1)$ for $j=1,\ldots,m\$​    |
| 2. $y = \sum_{j=1}^8 \beta_j x_j$                            | $\{x_j\}_{j=1}^m \sim N(\mathbf{0}, \boldsymbol{\Sigma}), \boldsymbol{\Sigma}_{ij}=0.5^{|i-j|}$ |
| 3. $y = \beta_1x_1 + \beta_2 x_2x_3 + \beta_3x_4 + \beta_4x_5x_6x_7 + \beta_5x_8$ | $x_j \stackrel{i.i.d}{\sim} N(0, 1)$ for $j=1,\ldots,m$      |
| 4. $y = \sum_{j=1}^4 \beta_j x_j^2 + \sum_{j=4}^8 \beta_j x_j$ | $x_j \stackrel{i.i.d}{\sim} N(0, 1)$ for $j=1,\ldots,m$      |
| 5. $y = \mathbf{W_2}^T\text{relu}(\mathbf{W_1 X})$           | $\mathbf{X} \sim N(\mathbf{0}, \boldsymbol{I}_8), \mathbf{W_1} \in \mathbb{R}^{32 \times 8},\mathbf{W_2} \in \mathbb{R}^{32}$ |
| 6. $P(y=1) = 1 / (1+\exp(-\sum_{j=1}^8 \beta_j x_j))$        | $x_j\stackrel{i.i.d}{\sim} N(0, 1)$ for $j=1,\ldots,m$       |
| 7. multi-classification (5 classes)                          | generated by `make\_classification` in scikit-learn          |

For **real data analysis**, we apply our method in two UCI benchmark data set summarized in the table below.

| Dataset               | Samples | Features | Task           |
| --------------------- | ------- | -------- | -------------- |
| Spambase              | 3680    | 57       | Classification |
| Communities and Crime | 1993    | 101      | Regression     |

You can run `.py` in the `synthetic_data_analysis` and `real_data_analysis` to get the results of this paper. Each file is self-contained.

